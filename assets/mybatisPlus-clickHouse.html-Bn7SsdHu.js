import{_ as n,c as a,e as p,o as e}from"./app-C7ucYrat.js";const t={};function c(l,s){return e(),a("div",null,s[0]||(s[0]=[p(`<h3 id="背景" tabindex="-1"><a class="header-anchor" href="#背景"><span>背景：</span></a></h3><blockquote><p>当前项目使用的 <code>mybatis-plus</code> 多数据源框架，使用方式可参考：</p><p>https://mp.baomidou.com/guide/dynamic-datasource.html#%E6%96%87%E6%A1%A3-documentation</p><p>默认多数据源配置，并不支持clickHouse 多节点信息，可通过如下方式扩展：</p></blockquote><h3 id="pom-xml" tabindex="-1"><a class="header-anchor" href="#pom-xml"><span>pom.xml</span></a></h3><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="line">...</span>
<span class="line"></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mybatis.plus.version</span><span class="token punctuation">&gt;</span></span>3.4.3.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mybatis.plus.version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dynamic.datasource.version</span><span class="token punctuation">&gt;</span></span>3.4.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dynamic.datasource.version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>clickhouse.version</span><span class="token punctuation">&gt;</span></span>0.3.1-patch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>clickhouse.version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span>
<span class="line">...</span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>ru.yandex.clickhouse<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>clickhouse-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${clickhouse.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${mybatis.plus.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>dynamic-datasource-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${dynamic.datasource.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="java代码" tabindex="-1"><a class="header-anchor" href="#java代码"><span>Java代码：</span></a></h3><blockquote><p>增加自定义的动态数据源配置</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre class="language-java"><code><span class="line"><span class="token comment">// 保证执行顺序在前面，否则 会被其他加载器给创建，导致自定义的加载器执行不到</span></span>
<span class="line"><span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token annotation punctuation">@Configuration</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DynamicDataSourceConfig</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractDataSourceCreator</span> <span class="token keyword">implements</span> <span class="token class-name">DataSourceCreator</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">protected</span> <span class="token class-name">DynamicDataSourceConfig</span><span class="token punctuation">(</span><span class="token class-name">DynamicDataSourceProperties</span> dynamicDataSourceProperties<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">super</span><span class="token punctuation">(</span>dynamicDataSourceProperties<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Override</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">doCreateDataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSourceProperty</span> dataSourceProperty<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// 如果需要其他参数，自行加入，可以在配置文件配置，此处从dataSourceProperty获取，并填充</span></span>
<span class="line">        <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">// 使用clickHouse</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BalancedClickhouseDataSource</span><span class="token punctuation">(</span>dataSourceProperty<span class="token punctuation">.</span><span class="token function">getUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> properties<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token annotation punctuation">@Override</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">support</span><span class="token punctuation">(</span><span class="token class-name">DataSourceProperty</span> dataSourceProperty<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// 适配器模式，判断是否需要使用当前动态数据源创建</span></span>
<span class="line">        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">DataSource</span><span class="token punctuation">&gt;</span></span> type <span class="token operator">=</span> dataSourceProperty<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token class-name">Boolean</span><span class="token punctuation">.</span><span class="token constant">FALSE</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">BalancedClickhouseDataSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>使用方式</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre class="language-java"><code><span class="line"><span class="token comment">// 标注此 mapper 查询使用 clickHouse 数据源，和 配置文件中名称对应</span></span>
<span class="line"><span class="token annotation punctuation">@DS</span><span class="token punctuation">(</span><span class="token string">&quot;clickHouse&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">TestMapper</span> <span class="token keyword">extends</span> <span class="token class-name">BaseMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TestEntity</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="application-yaml" tabindex="-1"><a class="header-anchor" href="#application-yaml"><span>application.yaml</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="line"><span class="token key atrule">spring</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">datasource</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">dynamic</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">primary</span><span class="token punctuation">:</span> master <span class="token comment">#指定默认数据源</span></span>
<span class="line">      <span class="token key atrule">strict</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line">      <span class="token key atrule">datasource</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">master</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver</span>
<span class="line">          <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//xxxx<span class="token punctuation">:</span>3306/xxx<span class="token punctuation">?</span>useUnicode=true<span class="token important">&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;zeroDateTimeBehavior=convertToNull</span></span>
<span class="line">          <span class="token key atrule">username</span><span class="token punctuation">:</span> xx</span>
<span class="line">          <span class="token key atrule">password</span><span class="token punctuation">:</span> xx</span>
<span class="line">          <span class="token key atrule">hikari</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token key atrule">minimum-idle</span><span class="token punctuation">:</span> <span class="token number">5</span></span>
<span class="line">            <span class="token key atrule">idle-timeout</span><span class="token punctuation">:</span> <span class="token number">600000</span></span>
<span class="line">            <span class="token key atrule">maximum-pool-size</span><span class="token punctuation">:</span> <span class="token number">20</span></span>
<span class="line">            <span class="token key atrule">max-lifetime</span><span class="token punctuation">:</span> <span class="token number">1800000</span></span>
<span class="line">            <span class="token key atrule">connection-timeout</span><span class="token punctuation">:</span> <span class="token number">6000</span></span>
<span class="line">            <span class="token key atrule">connection-test-query</span><span class="token punctuation">:</span> SELECT 1</span>
<span class="line">        <span class="token key atrule">clickHouse</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token comment"># 此处type 主要用作 java代码中适配器的判断</span></span>
<span class="line">          <span class="token key atrule">type</span><span class="token punctuation">:</span> ru.yandex.clickhouse.BalancedClickhouseDataSource</span>
<span class="line">          <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> ru.yandex.clickhouse.ClickHouseDriver</span>
<span class="line">          <span class="token comment"># jdbc:clickhouse://ip:port,ip:port/xxx 配置格式</span></span>
<span class="line">          <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>clickhouse<span class="token punctuation">:</span>//xxxx<span class="token punctuation">:</span><span class="token number">8123</span><span class="token punctuation">,</span>xxxx<span class="token punctuation">:</span>8123/xxx</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="原理解析" tabindex="-1"><a class="header-anchor" href="#原理解析"><span>原理解析</span></a></h3><h4 id="balancedclickhousedatasource-class" tabindex="-1"><a class="header-anchor" href="#balancedclickhousedatasource-class"><span>BalancedClickhouseDataSource.class</span></a></h4><blockquote><p>此数据源为<code>clickHouse</code>jdbc提供的集群<code>DataSource</code></p><p>所以我们要做的就是使用此数据源来创建<code>DataSource</code></p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre class="language-java"><code><span class="line"></span>
<span class="line">    <span class="token doc-comment comment">/**</span>
<span class="line">     * create Datasource for clickhouse JDBC connections</span>
<span class="line">     *</span>
<span class="line">     * <span class="token keyword">@param</span> <span class="token parameter">url</span> address for connection to the database</span>
<span class="line">     *            must have the next format <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java">jdbc<span class="token operator">:</span>clickhouse<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token operator">&lt;</span>first<span class="token operator">-</span>host<span class="token operator">&gt;</span><span class="token operator">:</span><span class="token generics"><span class="token punctuation">&lt;</span>port<span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span><span class="token operator">&lt;</span>second<span class="token operator">-</span>host<span class="token operator">&gt;</span><span class="token operator">:</span><span class="token generics"><span class="token punctuation">&lt;</span>port<span class="token punctuation">&gt;</span></span><span class="token operator">/</span><span class="token generics"><span class="token punctuation">&lt;</span>database<span class="token punctuation">&gt;</span></span><span class="token operator">?</span>param1<span class="token operator">=</span>value1<span class="token operator">&amp;</span>param2<span class="token operator">=</span>value2</span></span> <span class="token punctuation">}</span></span>
<span class="line">     *            for example, <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java">jdbc<span class="token operator">:</span>clickhouse<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8123</span><span class="token punctuation">,</span>localhost<span class="token operator">:</span><span class="token number">8123</span><span class="token operator">/</span>database<span class="token operator">?</span>compress<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>decompress<span class="token operator">=</span><span class="token number">2</span></span></span> <span class="token punctuation">}</span></span>
<span class="line">     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">IllegalArgumentException</span></span> if param have not correct format, or error happens when checking host availability</span>
<span class="line">     */</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">BalancedClickhouseDataSource</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> url<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token function">splitUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getFromUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="com-baomidou-dynamic-datasource-creator-defaultdatasourcecreator" tabindex="-1"><a class="header-anchor" href="#com-baomidou-dynamic-datasource-creator-defaultdatasourcecreator"><span>com.baomidou.dynamic.datasource.creator.DefaultDataSourceCreator</span></a></h4><blockquote><p>源码中，通过此类来初始化配置文件中的 数据源</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre class="language-java"><code><span class="line"><span class="token annotation punctuation">@Slf4j</span></span>
<span class="line"><span class="token annotation punctuation">@Setter</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultDataSourceCreator</span> <span class="token punctuation">{</span></span>
<span class="line">	  <span class="token comment">// 默认的实现类中，BasicDataSourceCreator 的 support方法始终为true，所以自定义的动态数据源配置，必须在 BasicDataSourceCreator 之前执行，需要设置 @Order</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DataSourceCreator</span><span class="token punctuation">&gt;</span></span> creators<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">createDataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSourceProperty</span> dataSourceProperty<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">DataSourceCreator</span> dataSourceCreator <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">DataSourceCreator</span> creator <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>creators<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">// 适配器判断，是否使用此数据源</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>creator<span class="token punctuation">.</span><span class="token function">support</span><span class="token punctuation">(</span>dataSourceProperty<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                dataSourceCreator <span class="token operator">=</span> creator<span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword">break</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>dataSourceCreator <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">&quot;creator must not be null,please check the DataSourceCreator&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment">// 创建数据源</span></span>
<span class="line">        <span class="token keyword">return</span> dataSourceCreator<span class="token punctuation">.</span><span class="token function">createDataSource</span><span class="token punctuation">(</span>dataSourceProperty<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,18)]))}const i=n(t,[["render",c],["__file","mybatisPlus-clickHouse.html.vue"]]),u=JSON.parse('{"path":"/blogs/jishu/spring/mybatisPlus-clickHouse.html","title":"mybatis-plus 动态数据源 clickHouse集群","lang":"en-US","frontmatter":{"title":"mybatis-plus 动态数据源 clickHouse集群","date":"2021-12-01T00:00:00.000Z","author":"shuiMu","categories":["技术"],"tags":["mybatis-plus","clickhouse"]},"headers":[{"level":3,"title":"背景：","slug":"背景","link":"#背景","children":[]},{"level":3,"title":"pom.xml","slug":"pom-xml","link":"#pom-xml","children":[]},{"level":3,"title":"Java代码：","slug":"java代码","link":"#java代码","children":[]},{"level":3,"title":"application.yaml","slug":"application-yaml","link":"#application-yaml","children":[]},{"level":3,"title":"原理解析","slug":"原理解析","link":"#原理解析","children":[]}],"git":{"createdTime":1729235013000,"updatedTime":1729235013000,"contributors":[{"name":"peng.li","email":"lip.app@qq.com","commits":1}]},"filePathRelative":"blogs/技术/spring/mybatisPlus-clickHouse.md"}');export{i as comp,u as data};
